function [CH_index] = CalinskiHarabasz(k, X, c,IDX,sumd);

% Calinski, T., and Harabasz, J. (1974). A dendrite method for cluster analysis.
% Communications in Statistics, 3 (1), 1-27.

% N = no. of data points
N = length(X);

% Mean of X, i.e., global center of all data
M = mean(X);

% BGSS, weighted sum of the squared distances between each cluster center and the global center
BGSS = 0
for i = 1:k;
	subtotal = length(find(IDX(:)==i)*(c(i) - M)^2;	
	BGSS = BGSS + subtotal;
end;

% Sum of the intra-cluster variances
WGSS = sum(sumd);

% Calinski-Harabasz index
CH_index = (BGSS*(N - k))/(WGSS*(k - 1));

end;