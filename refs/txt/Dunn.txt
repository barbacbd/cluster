function [Dunn_index] = Dunn(k, IDX, X);

% Dunn, J. (1974). Well separated clusters and optimal fuzzy partitioning.
% Journal of Cybernetics, 4, 95-104.

% Dk = largest distance b/w distinct pairs of points in a cluster (cluster diameter)
for i = 1:k;
     [rows,~] = find(IDX==i);
     Dk(i) = max(pdist(X(rows)));
end;

% dmax = maximum cluster diameter
dmax = max(Dk);

% dkk' = distance between the closest points in clusters k and k'
dkkprime = [];		% Concatonate after each loop
for i = 1:k;
     [rows1,~] = find(IDX==i);
     clust1 = X(rows1);
     for j = i+1:k;
	[rows2,~] = find(IDX==j);
	clust2 = X(rows2);
	point_dist = min(pdist2(clust1, clust2));
	dkkprime = [dkkprime point_dist];
     end;
end;
dmin = min(dkkprime);

%
Dunn_index = dmin/dmax;

end;